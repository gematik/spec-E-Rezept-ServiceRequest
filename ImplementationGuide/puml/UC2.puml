@startuml
autonumber "<b>[0]"
participant Pflegeeinrichtung as PE #LightBlue
participant Arzt as A #LightYellow
participant Apotheke as AP #LightGreen
participant "E-Rezept\nFachdienst" as FD #LightSalmon

activate PE
PE -> A++: <b>Prescription_ServiceRequest \n.status = active \n.basedOn = MEDREQ_Medication_Request
A -> FD++: E-Rezept einstellen
FD -> A--: Task(PrescriptionID, AccessCode)
A -> PE: <b>Prescription_ServiceRequest \n.status = completed \n.basedOn = KBV_Prescription
A -> AP--++: <b>Dispense_ServiceRequest \n.status = active \n.basedOn = KBV_Prescription \n.extension:EPrescriptionToken = E-Rezept Token
AP -> PE: <b>Dispense_ServiceRequest \n.status = active \n.basedOn = KBV_Prescription
AP <-> FD: E-Rezept einlÃ¶sen
AP -> PE--: <b>Dispense_ServiceRequest \n.status = completed \n.basedOn = KBV_Prescription \n.extension:EPrescriptionToken = E-Rezept Token
@enduml
