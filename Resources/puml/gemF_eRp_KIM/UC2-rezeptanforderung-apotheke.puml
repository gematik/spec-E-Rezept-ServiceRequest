@startuml name = "UC2-Rezeptanforderung-Apotheke"


skinparam maxMessageSize 200

actor Apotheke
actor "Pflegeeinrichtung" as Pflegeeinrichtung
actor "Verordnender \nLeistungserbringer" as Arztpraxis

title UC2-Rezeptanforderungen durch heimversorgende Apotheke
hide footbox
autonumber "<b>[0]"

legend bottom right
    __Legende__
    |<#PaleGreen> Ergebnis: Medikamentabgabe|
    |<#LightPink> Ergebnis: keine Medikamentabgabe|
    **lfd.Nr.** //Informationseinheit als Nachricht übermittelt//
    **lfd.Nr.** **sonstige Aktivität**
endlegend

Apotheke ->> Arztpraxis: //Rezeptanforderung//
Apotheke --> Pflegeeinrichtung: //ServiceRequest_Nachricht_Kopie//

opt #LightPink Stornierung
    Apotheke ->> Arztpraxis: //Rezeptanforderung_Storno//
    Apotheke --> Pflegeeinrichtung: //ServiceRequest_Nachricht_Kopie//
    alt #LightPink E-Rezept noch nicht eingestellt
    Apotheke -[hidden]-> Arztpraxis: Rezeptanforderung wird verworfen
        Arztpraxis ->x Arztpraxis: Rezeptanforderung wird verworfen
        Arztpraxis --> Pflegeeinrichtung: //ServiceRequest_Nachricht_Kopie//
    else #LightPink E-Rezept wurde eingestellt
        Arztpraxis ->x Arztpraxis: E-Rezept wird gelöscht
        Arztpraxis --> Pflegeeinrichtung: //ServiceRequest_Nachricht_Kopie//
    end
end


alt #PaleGreen Arzt ist einverstanden 
    Arztpraxis ->> Apotheke: //Rezeptanforderung_Bestätigung//
    Arztpraxis --> Pflegeeinrichtung: //ServiceRequest_Nachricht_Kopie//
    Apotheke ->> Pflegeeinrichtung: //Dispensieranforderung_Bestätigung//
    Apotheke ->> Pflegeeinrichtung: Medikamentenbelieferung

else #LightPink Arzt lehnt ab
    Arztpraxis ->> Apotheke: //Rezeptanforderung_Storno//
    Arztpraxis --> Pflegeeinrichtung: //ServiceRequest_Nachricht_Kopie//
end


@enduml